angular.module("lib/Core/map.html",[]).run(["$templateCache",function(a){"use strict";a.put("lib/Core/map.html","<leaflet class=sidebar-map id=mymap1 center=bastia layers=layers></leaflet>")}]),angular.module("lib/Core/map.html",[]).run(["$templateCache",function(a){"use strict";a.put("lib/Core/map.html","<leaflet class=sidebar-map id=mymap1 center=bastia layers=layers></leaflet>")}]),angular.module("lib/Core/map.html",[]).run(["$templateCache",function(a){"use strict";a.put("lib/Core/map.html","<leaflet class=sidebar-map id=mymap1 center=bastia layers=layers></leaflet>")}]),angular.module("lib/Core/map.html",[]).run(["$templateCache",function(a){"use strict";a.put("lib/Core/map.html","<leaflet class=sidebar-map id=mymap1 center=bastia layers=layers></leaflet>")}]),angular.module("lib/Core/map.html",[]).run(["$templateCache",function(a){"use strict";a.put("lib/Core/map.html","<leaflet class=sidebar-map id=mymap1 center=bastia layers=layers></leaflet>")}]);var xmod=angular.module("lba.Core",["lib/Core/map.html"]),app;!function(a){var b;!function(a){"use strict";var b=function(){function a(){}return a}();a.MapTileLayerOptions=b;var c=function(){function a(){this.restrict="E",this.templateUrl="lib/Core/map.html",this.transclude=!0,this.scope={datasource:"=",popupfunction:"="},this.controller=["$rootScope","$scope","leafletData","mapService","$attrs",function(a,b,c,d,e){var f="As3LPVTMbjlvopcBUBWlbYazvuvTE4MOUg5kr1oP0G_faR4baF4b0KDxTUAy4w4a";angular.extend(b,{bastia:{lat:39.0997,lng:-94.5786,zoom:4},markers:{bastia:{lat:39.0997,lng:-94.5786}},layers:{baselayers:{}}}),c.getMap("mymap1").then(function(c){a.MYMAP=c,a.mrkgrp=[],a.ALLMARKERS=b.datasource,a.getBaseLayers=d.getBaseLayers;var e=a.getBaseLayers(c);e["Bing Aerial Map"].addTo(c);var g=new L.Control.Layers(e).addTo(c);a.layerControl=g,a.previouszoom=c.getZoom(),$(".leaflet-control-zoom").css("visibility","visible"),a.$emit("AddedPrimaryControls",[c,f]),b.$watchCollection("datasource",function(){if(void 0!=b.datasource)for(var a=0;a<b.datasource.length;a++)c.addLayer(b.CreateMarkers(b.datasource[a]))})}),b.CreateMarkers=function(a){var b=this,c=new L.LatLng(a.location.latitude,a.location.longitude),d={radius:8,fillColor:"#00f",color:"#fff",weight:2,opacity:1,fillOpacity:.8},e=L.circleMarker(c,d);return e.MainColor="#00f",e.Feature=a,e.ID=a.ID,e.on("mouseover",function(a){var b="#7bbf50";this.setStyle({radius:12,fillOpacity:1,color:"#fff",fillColor:b})}),e.on("mouseout",function(a){this.setStyle({radius:8,fillOpacity:1,color:"#fff",fillColor:this.MainColor})}),e.on("click",function(a){b.popupfunction(e)}),e}}],console.log("xmap constructor called")}return a.getInstance=function(){return new a},a}();angular.module("lba.Core").directive("lbaMap",function(){return c.getInstance()})}(b=a.map||(a.map={}))}(app||(app={}));var mapModule;!function(a){"use strict";var b=function(){function b(a){this.$http=a}return b.prototype.getBaseLayers=function(b,c){var d=new L.BingLayer(a.MapService.bingKey),e=new L.BingLayer(a.MapService.bingKey,{subdomains:[0,1,2,3],type:"Road",attribution:"Bing",culture:""});e.options.attribution=' Property data &copy; by <a href="http://xceligent.com/" target="_blank"> <img src="../images/xceligent-little-logo.png"></a>';var f;f=new app.map.MapTileLayerOptions,f.attribution='Map tiles by <a href="http://stamen.com">Stamen Design</a>, <a href="http://creativecommons.org/licenses/by/3.0">CC BY 3.0</a> &mdash; Map data &copy; <a href="http://openstreetmap.org">OpenStreetMap</a> contributors, <a href="http://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>',f.subdomains=["a","b","c","d"],f.minZoom=0,f.maxZoom=20;var g,h=L.tileLayer("http://{s}.tile.stamen.com/toner/{z}/{x}/{y}.png",f);g=new app.map.MapTileLayerOptions,f.attribution='&copy;2012 Esri & Stamen, Data from OSM and Natural Earth | Property data &copy; by <a href="http://xceligent.com/" target="_blank"> <img src="../images/xceligent-little-logo.png"></a>',f.subdomains=["0","1","2","3"],f.minZoom=0,f.maxZoom=18;var i=L.tileLayer("http://a{s}.acetate.geoiq.com/tiles/acetate-hillshading/{z}/{x}/{y}.png",g),j={"Bing Aerial Map":d,"Bing Street Map":e,"Driving Map":h,"Open Street Map":i};return j},b.bingKey="As3LPVTMbjlvopcBUBWlbYazvuvTE4MOUg5kr1oP0G_faR4baF4b0KDxTUAy4w4a",b}();a.MapService=b}(mapModule||(mapModule={})),angular.module("lba.Core").factory("mapService",function(a){return new mapModule.MapService(a)}),angular.module("lib/Core/map.html",[]).run(["$templateCache",function(a){"use strict";a.put("lib/Core/map.html","<leaflet class=sidebar-map id=mymap1 center=bastia layers=layers></leaflet>")}]),L.BingLayer=L.TileLayer.extend({options:{subdomains:[0,1,2,3],type:"AerialWithLabels",attribution:"Bing",culture:""},initialize:function(a,b){L.Util.setOptions(this,b),this._key=a,this._url=null,this.meta={},this.loadMetadata()},tile2quad:function(a,b,c){for(var d="",e=c;e>0;e--){var f=0,g=1<<e-1;0!=(a&g)&&(f+=1),0!=(b&g)&&(f+=2),d+=f}return d},getTileUrl:function(a,b){var b=this._getZoomForUrl(),c=this.options.subdomains,d=this.options.subdomains[Math.abs((a.x+a.y)%c.length)];return this._url.replace("{subdomain}",d).replace("{quadkey}",this.tile2quad(a.x,a.y,b)).replace("{culture}",this.options.culture)},loadMetadata:function(){var a=this,b="_bing_metadata_"+L.Util.stamp(this);window[b]=function(c){a.meta=c,window[b]=void 0;var d=document.getElementById(b);return d.parentNode.removeChild(d),c.errorDetails?void(window.console&&console.log("Leaflet Bing Plugin Error - Got metadata: "+c.errorDetails)):void a.initMetadata()};var c=document.location.protocol+"//dev.virtualearth.net/REST/v1/Imagery/Metadata/"+this.options.type+"?include=ImageryProviders&jsonp="+b+"&key="+this._key+"&UriScheme="+document.location.protocol.slice(0,-1),d=document.createElement("script");d.type="text/javascript",d.src=c,d.id=b,document.getElementsByTagName("head")[0].appendChild(d)},initMetadata:function(){var a=this.meta.resourceSets[0].resources[0];if(this.options.subdomains=a.imageUrlSubdomains,this._url=a.imageUrl,this._providers=[],a.imageryProviders)for(var b=0;b<a.imageryProviders.length;b++)for(var c=a.imageryProviders[b],d=0;d<c.coverageAreas.length;d++){var e=c.coverageAreas[d],f={zoomMin:e.zoomMin,zoomMax:e.zoomMax,active:!1},g=new L.LatLngBounds(new L.LatLng(e.bbox[0]+.01,e.bbox[1]+.01),new L.LatLng(e.bbox[2]-.01,e.bbox[3]-.01));f.bounds=g,f.attrib=c.attribution,this._providers.push(f)}this._update()},_update:function(){null!=this._url&&this._map&&(this._update_attribution(),L.TileLayer.prototype._update.apply(this,[]))},_update_attribution:function(){for(var a=this._map.getBounds(),b=this._map.getZoom(),c=0;c<this._providers.length;c++){var d=this._providers[c];b<=d.zoomMax&&b>=d.zoomMin&&a.intersects(d.bounds)?(!d.active&&this._map.attributionControl&&this._map.attributionControl.addAttribution(d.attrib),d.active=!0):(d.active&&this._map.attributionControl&&this._map.attributionControl.removeAttribution(d.attrib),d.active=!1)}},onRemove:function(a){for(var b=0;b<this._providers.length;b++){var c=this._providers[b];c.active&&this._map.attributionControl&&(this._map.attributionControl.removeAttribution(c.attrib),c.active=!1)}L.TileLayer.prototype.onRemove.apply(this,[a])}}),L.bingLayer=function(a,b){return new L.BingLayer(a,b)};